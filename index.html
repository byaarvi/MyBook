<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>My Book Flipbook</title>
<style>
  body { 
    margin:0; 
    display:flex; 
    justify-content:center; 
    align-items:center; 
    height:100vh; 
    background:#ccc; 
  }
  #flipbook {
    width:900px;
    height:600px;
  }
  #flipbook .page {
    width:450px;   /* half of flipbook width (book ke 2 page ek sath) */
    height:600px;
    background:white;
    box-shadow:0 0 5px rgba(0,0,0,0.3);
  }
  #flipbook canvas {
    width:100%;
    height:100%;
    display:block;
  }
</style>
</head>
<body>
<div id="flipbook"></div>

<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- turn.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/turn.js/4.1.0/turn.min.js"></script>
<!-- PDF.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.14.305/pdf.min.js"></script>

<script>
pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.14.305/pdf.worker.min.js';

const url = 'https://byaarvi.github.io/MyBook/MyBook.pdf';
const flipbook = document.getElementById('flipbook');

pdfjsLib.getDocument(url).promise.then(pdf => {
  console.log('PDF loaded, total pages:', pdf.numPages);

  let loadedPages = 0;

  for (let i = 1; i <= pdf.numPages; i++) {
    const pageDiv = document.createElement('div');
    pageDiv.className = 'page';
    const canvas = document.createElement('canvas');
    pageDiv.appendChild(canvas);
    flipbook.appendChild(pageDiv);

    pdf.getPage(i).then(page => {
      const viewport = page.getViewport({ scale: 1.5 });
      canvas.width = viewport.width;
      canvas.height = viewport.height;

      const renderContext = {
        canvasContext: canvas.getContext('2d'),
        viewport: viewport
      };
      page.render(renderContext).promise.then(() => {
        loadedPages++;
        if (loadedPages === pdf.numPages) {
          // âœ… Initialize flipbook only after all pages rendered
          $('#flipbook').turn({
            width: 900,
            height: 600,
            autoCenter: true,
            display: 'double'
          });
        }
      });
    });
  }
}).catch(err => {
  console.error('PDF load error:', err);
});
</script>
</body>
</html>
